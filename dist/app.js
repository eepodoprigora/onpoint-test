"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var n=function(){function e(i){t(this,e),this.containerNode=i,this.size=i.childElementCount,this.manageHTML=this.manageHTML.bind(this),this.setParameters=this.setParameters.bind(this),this.setEvents=this.setEvents.bind(this),this.startDrag=this.startDrag.bind(this),this.stopDrag=this.stopDrag.bind(this),this.dragging=this.dragging.bind(this),this.setStylePosition=this.setStylePosition.bind(this),this.manageHTML(),this.setParameters(),this.setEvents()}return i(e,[{key:"setParameters",value:function(){var t=this,e=this.containerNode.getBoundingClientRect();this.height=e.height,this.lineNode.style.height="".concat(this.size*this.height,"px"),Array.from(this.slideNodes).forEach((function(e){e.style.height="".concat(t.height,"px")}))}},{key:"manageHTML",value:function(){this.containerNode.innerHTML='\n     <div class="'.concat("second-slider__line",'">\n     ').concat(this.containerNode.innerHTML,'\n     </div>\n\n     <div class="').concat("scroll-wrapper",'" >\n   <div class="').concat("scroll-base",'"></div>\n   <div class="').concat("scroll-pointer",'"></div>\n   </div>\n   '),this.scrollNode=this.containerNode.querySelector(".".concat("scroll-wrapper")),document.querySelector(".scroll").append(this.scrollNode),this.lineNode=this.containerNode.querySelector(".".concat("second-slider__line")),this.scrollPointer=this.scrollNode.querySelector(".".concat("scroll-pointer")),this.scrollBase=this.scrollNode.querySelector(".".concat("scroll-base")),this.slideNodes=Array.from(this.lineNode.children).map((function(t){return s({element:t,className:"second-slider__item-wrapper"})}))}},{key:"setEvents",value:function(){this.scrollPointer.addEventListener("pointerdown",this.startDrag),window.addEventListener("pointerup",this.stopDrag)}},{key:"startDrag",value:function(t){window.addEventListener("pointermove",this.dragging),this.clickY=t.pageY}},{key:"stopDrag",value:function(t){window.removeEventListener("pointermove",this.dragging),this.scrollPointer.removeEventListener("pointermove",this.dragging),this.scrollNode.classList.remove("active-scroll")}},{key:"dragging",value:function(t){this.dragY=t.pageY;var e=this.dragY-this.clickY;this.setStylePosition(e),(this.scrollPointer.getBoundingClientRect().top<this.scrollBase.getBoundingClientRect().top||this.scrollPointer.getBoundingClientRect().bottom>this.scrollBase.getBoundingClientRect().bottom)&&this.stopDrag(),this.scrollNode.classList.add("active-scroll")}},{key:"setStylePosition",value:function(t){this.lineNode.style.transform="translate3d(0, -".concat(t,"px, 0)"),this.scrollPointer.style.transform="translate3d(0, ".concat(t,"px, 0)")}}]),e}();function s(t){var e=t.element,i=t.className,n=document.createElement("div");return n.classList.add(i),e.parentNode.insertBefore(n,e),n.appendChild(e),n}function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function r(t,e){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},r(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=l(t);if(e){var s=l(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return c(this,i)}}function c(t,e){if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function l(t){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},l(t)}function h(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return d(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return d(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,s=function(){};return{s:s,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){a=!0,o=t},f:function(){try{r||null==i.return||i.return()}finally{if(a)throw o}}}}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var u=function(){function e(i){t(this,e),this.containerNode=i,this.size=i.childElementCount,this.currentSlide=0,this.currentSlideWasChanged=!1,this.manageHTML=this.manageHTML.bind(this),this.setParameters=this.setParameters.bind(this),this.setEvents=this.setEvents.bind(this),this.resizeSlider=this.resizeSlider.bind(this),this.startDrag=this.startDrag.bind(this),this.stopDrag=this.stopDrag.bind(this),this.dragging=this.dragging.bind(this),this.setStylePosition=this.setStylePosition.bind(this),this.setStyleTransition=this.setStyleTransition.bind(this),this.resetStyleTransition=this.resetStyleTransition.bind(this),this.goHome=this.goHome.bind(this),this.goToSecondSlide=this.goToSecondSlide.bind(this),this.openPopup=this.openPopup.bind(this),this.closePopup=this.closePopup.bind(this),this.clickDots=this.clickDots.bind(this),this.moveToLeft=this.moveToLeft.bind(this),this.moveToRight=this.moveToRight.bind(this),this.changeCurrentSlide=this.changeCurrentSlide.bind(this),this.changeActiveDotClass=this.changeActiveDotClass.bind(this),this.manageHTML(),this.setParameters(),this.setEvents()}return i(e,[{key:"setParameters",value:function(){var t=this,e=this.containerNode.getBoundingClientRect();this.width=e.width,this.maximumX=-(this.size-1)*this.width,this.x=-this.currentSlide*this.width,this.resetStyleTransition(),this.lineNode.style.width="".concat(this.size*this.width,"px"),this.setStylePosition(),Array.from(this.slideNodes).forEach((function(e){e.style.width="".concat(t.width,"px")}))}},{key:"manageHTML",value:function(){var t=this;this.containerNode.innerHTML='\n     <div class="'.concat("slider__line",'">\n     ').concat(this.containerNode.innerHTML,'\n     </div>\n     <div class="').concat("slide__nav",'">\n     <button class="').concat("slide__nav-left",'"></button>\n     <button class="').concat("slide__nav-right",'"></button>\n    </div>\n    <div class="').concat("slide__dots",'"></div>\n     '),this.lineNode=this.containerNode.querySelector(".".concat("slider__line")),this.dotsNode=this.containerNode.querySelector(".".concat("slide__dots")),this.homeButton=document.querySelector(".home__button"),this.whatsNextButton=document.querySelector(".whats-next"),console.log(this.whatsNextButton),this.moreButton=document.querySelector(".slide__more"),this.closePopupButton=document.querySelector(".popup__close"),this.popup=document.querySelector(".popup"),this.body=document.querySelector("body"),this.scroll=document.querySelector(".scroll"),this.muchSperm=document.querySelectorAll(".slide__pink-sperm-second"),this.slideNodes=Array.from(this.lineNode.children).map((function(t){return s({element:t,className:"slider__item-wrapper"})})),this.dotsNode.innerHTML=Array.from(Array(this.size).keys()).map((function(e){return'<button class="'.concat("slide__dot","  ").concat(e===t.currentSlide?"slide__dot-active":"",'"</button> ')})).join(""),this.dotNodes=this.dotsNode.querySelectorAll(".".concat("slide__dot")),this.navLeft=this.containerNode.querySelector(".".concat("slide__nav-left")),this.navRight=this.containerNode.querySelector(".".concat("slide__nav-right"))}},{key:"setEvents",value:function(){this.debounceResizeSlider=function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return function(n){clearTimeout(e),e=setTimeout(t,i,n)}}(this.resizeSlider),window.addEventListener("resize",this.debounceResizeSlider),window.addEventListener("pointerup",this.stopDrag),this.moreButton.addEventListener("click",this.debounceResizeSlider),this.lineNode.addEventListener("pointerdown",this.startDrag),this.homeButton.addEventListener("click",this.goHome),this.whatsNextButton.addEventListener("click",this.goToSecondSlide),this.moreButton.addEventListener("click",this.openPopup),this.closePopupButton.addEventListener("click",this.closePopup),this.dotsNode.addEventListener("click",this.clickDots),this.navLeft.addEventListener("click",this.moveToLeft),this.navRight.addEventListener("click",this.moveToRight),this.scroll.addEventListener("pointerdown",this.stopDrag)}},{key:"clickDots",value:function(t){var e=t.target.closest("button");if(e){for(var i,n=0;n<this.dotNodes.length;n++)if(this.dotNodes[n]===e){i=n;break}i!==this.currentSlide&&(this.currentSlide=i,this.changeCurrentSlide())}}},{key:"moveToLeft",value:function(){this.currentSlide<=0||(this.currentSlide=this.currentSlide-1,this.changeCurrentSlide())}},{key:"moveToRight",value:function(){this.currentSlide>=this.size-1||(this.currentSlide=this.currentSlide+1,this.changeCurrentSlide())}},{key:"changeCurrentSlide",value:function(){this.x=-this.currentSlide*this.width,this.setStylePosition(),this.setStyleTransition(),this.changeActiveDotClass()}},{key:"changeActiveDotClass",value:function(){for(var t=0;t<this.dotNodes.length;t++)this.dotNodes[t].classList.remove("slide__dot-active");this.dotNodes[this.currentSlide].classList.add("slide__dot-active")}},{key:"closePopup",value:function(){this.popup.classList.remove("popup--active"),this.lineNode.addEventListener("pointerdown",this.startDrag)}},{key:"openPopup",value:function(){this.popup.classList.add("popup--active"),this.lineNode.removeEventListener("pointerdown",this.startDrag)}},{key:"goToSecondSlide",value:function(){this.lineNode.style.transform="translate3d(-".concat(this.width,"px, 0, 0)"),this.currentSlide=1,this.spermAnimate()}},{key:"goHome",value:function(){this.lineNode.style.transform="translate3d(0, 0, 0)",this.currentSlide=0;var t,e=h(this.muchSperm);try{for(e.s();!(t=e.n()).done;){t.value.classList.remove("animating")}}catch(t){e.e(t)}finally{e.f()}}},{key:"destroyEvents",value:function(){window.removeEventListener("resize",this.debounceResizeSlider),window.removeEventListener("pointerup",this.stopDrag),this.lineNode.removeEventListener("pointerdown",this.startDrag),this.dotsNode.removeEventListener("click",this.clickDots),this.navLeft.removeEventListener("click",this.moveToLeft),this.navRight.removeEventListener("click",this.moveToRight)}},{key:"resizeSlider",value:function(){this.setParameters()}},{key:"startDrag",value:function(t){this.currentSlideWasChanged=!1,this.clickX=t.pageX,this.clickY=t.pageY,this.startX=this.x,this.resetStyleTransition(),window.addEventListener("pointermove",this.dragging)}},{key:"stopDrag",value:function(){window.removeEventListener("pointermove",this.dragging),this.containerNode.classList.remove("slider-draggable"),this.changeCurrentSlide(),1===this.currentSlide&&this.spermAnimate();var t,e=h(document.getElementsByTagName("img"));try{for(e.s();!(t=e.n()).done;){t.value.ondragstart=function(){return!1}}}catch(t){e.e(t)}finally{e.f()}}},{key:"spermAnimate",value:function(){var t,e=h(this.muchSperm);try{for(e.s();!(t=e.n()).done;){t.value.classList.add("animating")}}catch(t){e.e(t)}finally{e.f()}}},{key:"dragging",value:function(t){if(!document.querySelector(".scroll-wrapper").classList.contains("active-scroll")){this.dragX=t.pageX;var e=this.dragX-this.clickX,i=e/5;this.x=Math.max(Math.min(this.startX+e,i),this.maximumX+i),this.setStylePosition(),e>20&&e>0&&!this.currentSlideWasChanged&&this.currentSlide>0&&(this.containerNode.classList.add("slider-draggable"),this.currentSlideWasChanged=!0,this.currentSlide=this.currentSlide-1),e<-20&&e<0&&!this.currentSlideWasChanged&&this.currentSlide<this.size-1&&(this.containerNode.classList.add("slider-draggable"),this.currentSlideWasChanged=!0,this.currentSlide=this.currentSlide+1)}}},{key:"setStylePosition",value:function(){this.lineNode.style.transform="translate3d(".concat(this.x,"px, 0, 0)")}},{key:"setStyleTransition",value:function(){this.lineNode.style.transition="all .3s ease 0s"}},{key:"resetStyleTransition",value:function(){this.lineNode.style.transition="all 0 ease 0s"}}]),e}();function s(t){var e=t.element,i=t.className,n=document.createElement("div");return n.classList.add(i),e.parentNode.insertBefore(n,e),n.appendChild(e),n}var f=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&r(t,e)}(s,u);var n=a(s);function s(e){return t(this,s),n.call(this,e)}return i(s,[{key:"openPopup",value:function(){this.lineNode.addEventListener("pointerdown",this.startDrag)}}]),s}();new u(document.getElementById("slider__main")),new n(document.getElementById("second-slider")),window.addEventListener("load",(function(){new f(document.getElementById("popup__slider"))}));
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkZFNsaWRlci5qcyIsInNsaWRlci5qcyIsIm1haW4uanMiXSwibmFtZXMiOlsiQWRkU2xpZGVyIiwiZWxlbWVudCIsIl9jbGFzc0NhbGxDaGVjayIsInRoaXMiLCJjb250YWluZXJOb2RlIiwic2l6ZSIsImNoaWxkRWxlbWVudENvdW50IiwibWFuYWdlSFRNTCIsImJpbmQiLCJzZXRQYXJhbWV0ZXJzIiwic2V0RXZlbnRzIiwic3RhcnREcmFnIiwic3RvcERyYWciLCJkcmFnZ2luZyIsInNldFN0eWxlUG9zaXRpb24iLCJfdGhpcyIsImNvb3Jkc0NvbnRhaW5lciIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsImhlaWdodCIsImxpbmVOb2RlIiwic3R5bGUiLCJjb25jYXQiLCJBcnJheSIsImZyb20iLCJzbGlkZU5vZGVzIiwiZm9yRWFjaCIsInNsaWRlTm9kZSIsImlubmVySFRNTCIsInNjcm9sbE5vZGUiLCJxdWVyeVNlbGVjdG9yIiwiZG9jdW1lbnQiLCJhcHBlbmQiLCJzY3JvbGxQb2ludGVyIiwic2Nyb2xsQmFzZSIsImNoaWxkcmVuIiwibWFwIiwiY2hpbGROb2RlIiwid3JhcEVsZW1lbnRCeURpdiIsImNsYXNzTmFtZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJ3aW5kb3ciLCJlIiwiY2xpY2tZIiwicGFnZVkiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwiZHJhZ1kiLCJkcmFnU2hpZnQiLCJ0b3AiLCJib3R0b20iLCJhZGQiLCJzaGlmdCIsInRyYW5zZm9ybSIsIl9yZWYiLCJ3cmFwcGVyTm9kZSIsImNyZWF0ZUVsZW1lbnQiLCJwYXJlbnROb2RlIiwiaW5zZXJ0QmVmb3JlIiwiYXBwZW5kQ2hpbGQiLCJTbGlkZXIiLCJjdXJyZW50U2xpZGUiLCJjdXJyZW50U2xpZGVXYXNDaGFuZ2VkIiwicmVzaXplU2xpZGVyIiwic2V0U3R5bGVUcmFuc2l0aW9uIiwicmVzZXRTdHlsZVRyYW5zaXRpb24iLCJnb0hvbWUiLCJnb1RvU2Vjb25kU2xpZGUiLCJvcGVuUG9wdXAiLCJjbG9zZVBvcHVwIiwiY2xpY2tEb3RzIiwibW92ZVRvTGVmdCIsIm1vdmVUb1JpZ2h0IiwiY2hhbmdlQ3VycmVudFNsaWRlIiwiY2hhbmdlQWN0aXZlRG90Q2xhc3MiLCJ3aWR0aCIsIm1heGltdW1YIiwieCIsIl90aGlzMiIsImRvdHNOb2RlIiwiaG9tZUJ1dHRvbiIsIndoYXRzTmV4dEJ1dHRvbiIsImNvbnNvbGUiLCJsb2ciLCJtb3JlQnV0dG9uIiwiY2xvc2VQb3B1cEJ1dHRvbiIsInBvcHVwIiwiYm9keSIsInNjcm9sbCIsIm11Y2hTcGVybSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJrZXlzIiwia2V5Iiwiam9pbiIsImRvdE5vZGVzIiwibmF2TGVmdCIsIm5hdlJpZ2h0IiwiZGVib3VuY2VSZXNpemVTbGlkZXIiLCJmdW5jIiwidGltZXIiLCJ0aW1lIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwiY2xlYXJUaW1lb3V0Iiwic2V0VGltZW91dCIsImRlYm91bmNlIiwiZG90Tm9kZSIsInRhcmdldCIsImNsb3Nlc3QiLCJkb3ROdW1iZXIiLCJpIiwic3Blcm1BbmltYXRlIiwiX3N0ZXAiLCJfaXRlcmF0b3IiLCJfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlciIsInMiLCJuIiwiZG9uZSIsInZhbHVlIiwiZXJyIiwiZiIsImNsaWNrWCIsInBhZ2VYIiwic3RhcnRYIiwiX3N0ZXAyIiwiX2l0ZXJhdG9yMiIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwib25kcmFnc3RhcnQiLCJfc3RlcDMiLCJfaXRlcmF0b3IzIiwiY29udGFpbnMiLCJkcmFnWCIsImVhc2luZyIsIk1hdGgiLCJtYXgiLCJtaW4iLCJ0cmFuc2l0aW9uIiwiUG9wdXBTbGlkZXIiLCJfc3VwZXIiLCJjYWxsIiwiZ2V0RWxlbWVudEJ5SWQiXSwibWFwcGluZ3MiOiI2WEFBQSxJQVFNQSxFLFdBQ0osU0FBQUEsRUFBWUMsR0FBU0MsRUFBQUMsS0FBQUgsR0FDbkJHLEtBQUtD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QUMsS0FBQXpJLEtBQ2JGLEcsbUNBR1IsV0FDRUUsS0FBS2dCLFNBQVNvQixpQkFBaUIsY0FBZXBDLEtBQUtRLGUsS0NoVHZELElBQUlpRCxFQUFPOUIsU0FBUytHLGVBQWUsaUJBQ25DLElBQUk3SSxFQUFVOEIsU0FBUytHLGVBQWUsa0JBRXRDckcsT0FBT0QsaUJBQWlCLFFBQVMsV0FDL0IsSUFBSW1HLEVBQVk1RyxTQUFTK0csZUFBZSIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBTZWNvbmRTbGlkZXIgPSBcInNlY29uZC1zbGlkZXJcIjtcbmNvbnN0IFNlY29uZFNsaWRlckRyYWdnYWJsZUNsYXNzbmFtZSA9IFwic2Vjb25kLXNsaWRlci1kcmFnZ2FibGVcIjtcbmNvbnN0IFNlY29uZFNsaWRlckxpbmUgPSBcInNlY29uZC1zbGlkZXJfX2xpbmVcIjtcbmNvbnN0IFNlY29uZFNsaWRlQ2xhc3NOYW1lID0gXCJzZWNvbmQtc2xpZGVyX19pdGVtLXdyYXBwZXJcIjtcbmNvbnN0IFNjcm9sbFdyYXBwZXIgPSBcInNjcm9sbC13cmFwcGVyXCI7XG5jb25zdCBTY3JvbGxCYXNlID0gXCJzY3JvbGwtYmFzZVwiO1xuY29uc3QgU2Nyb2xsUG9pbnRlciA9IFwic2Nyb2xsLXBvaW50ZXJcIjtcblxuY2xhc3MgQWRkU2xpZGVyIHtcbiAgY29uc3RydWN0b3IoZWxlbWVudCkge1xuICAgIHRoaXMuY29udGFpbmVyTm9kZSA9IGVsZW1lbnQ7XG4gICAgdGhpcy5zaXplID0gZWxlbWVudC5jaGlsZEVsZW1lbnRDb3VudDtcblxuICAgIHRoaXMubWFuYWdlSFRNTCA9IHRoaXMubWFuYWdlSFRNTC5iaW5kKHRoaXMpO1xuICAgIHRoaXMuc2V0UGFyYW1ldGVycyA9IHRoaXMuc2V0UGFyYW1ldGVycy5iaW5kKHRoaXMpO1xuICAgIHRoaXMuc2V0RXZlbnRzID0gdGhpcy5zZXRFdmVudHMuYmluZCh0aGlzKTtcbiAgICB0aGlzLnN0YXJ0RHJhZyA9IHRoaXMuc3RhcnREcmFnLmJpbmQodGhpcyk7XG4gICAgdGhpcy5zdG9wRHJhZyA9IHRoaXMuc3RvcERyYWcuYmluZCh0aGlzKTtcbiAgICB0aGlzLmRyYWdnaW5nID0gdGhpcy5kcmFnZ2luZy5iaW5kKHRoaXMpO1xuICAgIHRoaXMuc2V0U3R5bGVQb3NpdGlvbiA9IHRoaXMuc2V0U3R5bGVQb3NpdGlvbi5iaW5kKHRoaXMpO1xuXG4gICAgdGhpcy5tYW5hZ2VIVE1MKCk7XG4gICAgdGhpcy5zZXRQYXJhbWV0ZXJzKCk7XG4gICAgdGhpcy5zZXRFdmVudHMoKTtcbiAgfVxuICBzZXRQYXJhbWV0ZXJzKCkge1xuICAgIGNvbnN0IGNvb3Jkc0NvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyTm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICB0aGlzLmhlaWdodCA9IGNvb3Jkc0NvbnRhaW5lci5oZWlnaHQ7XG4gICAgdGhpcy5saW5lTm9kZS5zdHlsZS5oZWlnaHQgPSBgJHt0aGlzLnNpemUgKiB0aGlzLmhlaWdodH1weGA7XG4gICAgQXJyYXkuZnJvbSh0aGlzLnNsaWRlTm9kZXMpLmZvckVhY2goKHNsaWRlTm9kZSkgPT4ge1xuICAgICAgc2xpZGVOb2RlLnN0eWxlLmhlaWdodCA9IGAke3RoaXMuaGVpZ2h0fXB4YDtcbiAgICB9KTtcbiAgfVxuICBtYW5hZ2VIVE1MKCkge1xuICAgIHRoaXMuY29udGFpbmVyTm9kZS5pbm5lckhUTUwgPSBgXG4gICAgIDxkaXYgY2xhc3M9XCIke1NlY29uZFNsaWRlckxpbmV9XCI+XG4gICAgICR7dGhpcy5jb250YWluZXJOb2RlLmlubmVySFRNTH1cbiAgICAgPC9kaXY+XG5cbiAgICAgPGRpdiBjbGFzcz1cIiR7U2Nyb2xsV3JhcHBlcn1cIiA+XG4gICA8ZGl2IGNsYXNzPVwiJHtTY3JvbGxCYXNlfVwiPjwvZGl2PlxuICAgPGRpdiBjbGFzcz1cIiR7U2Nyb2xsUG9pbnRlcn1cIj48L2Rpdj5cbiAgIDwvZGl2PlxuICAgYDtcblxuICAgIHRoaXMuc2Nyb2xsTm9kZSA9IHRoaXMuY29udGFpbmVyTm9kZS5xdWVyeVNlbGVjdG9yKGAuJHtTY3JvbGxXcmFwcGVyfWApO1xuXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zY3JvbGxcIikuYXBwZW5kKHRoaXMuc2Nyb2xsTm9kZSk7XG5cbiAgICB0aGlzLmxpbmVOb2RlID0gdGhpcy5jb250YWluZXJOb2RlLnF1ZXJ5U2VsZWN0b3IoYC4ke1NlY29uZFNsaWRlckxpbmV9YCk7XG4gICAgdGhpcy5zY3JvbGxQb2ludGVyID0gdGhpcy5zY3JvbGxOb2RlLnF1ZXJ5U2VsZWN0b3IoYC4ke1Njcm9sbFBvaW50ZXJ9YCk7XG4gICAgdGhpcy5zY3JvbGxCYXNlID0gdGhpcy5zY3JvbGxOb2RlLnF1ZXJ5U2VsZWN0b3IoYC4ke1Njcm9sbEJhc2V9YCk7XG5cbiAgICB0aGlzLnNsaWRlTm9kZXMgPSBBcnJheS5mcm9tKHRoaXMubGluZU5vZGUuY2hpbGRyZW4pLm1hcCgoY2hpbGROb2RlKSA9PlxuICAgICAgd3JhcEVsZW1lbnRCeURpdih7XG4gICAgICAgIGVsZW1lbnQ6IGNoaWxkTm9kZSxcbiAgICAgICAgY2xhc3NOYW1lOiBTZWNvbmRTbGlkZUNsYXNzTmFtZSxcbiAgICAgIH0pXG4gICAgKTtcbiAgfVxuXG4gIHNldEV2ZW50cygpIHtcbiAgICB0aGlzLnNjcm9sbFBvaW50ZXIuYWRkRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJkb3duXCIsIHRoaXMuc3RhcnREcmFnKTtcbiAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcnVwXCIsIHRoaXMuc3RvcERyYWcpO1xuICB9XG5cbiAgc3RhcnREcmFnKGUpIHtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJtb3ZlXCIsIHRoaXMuZHJhZ2dpbmcpO1xuICAgIHRoaXMuY2xpY2tZID0gZS5wYWdlWTtcblxuICB9XG5cbiAgc3RvcERyYWcoZSkge1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwicG9pbnRlcm1vdmVcIiwgdGhpcy5kcmFnZ2luZyk7XG4gICAgdGhpcy5zY3JvbGxQb2ludGVyLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJwb2ludGVybW92ZVwiLCB0aGlzLmRyYWdnaW5nKTtcbiAgICB0aGlzLnNjcm9sbE5vZGUuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlLXNjcm9sbCcpXG4gIH1cblxuICBkcmFnZ2luZyhlKSB7XG4gICAgdGhpcy5kcmFnWSA9IGUucGFnZVk7XG4gICAgY29uc3QgZHJhZ1NoaWZ0ID0gdGhpcy5kcmFnWSAtIHRoaXMuY2xpY2tZO1xuICAgIHRoaXMuc2V0U3R5bGVQb3NpdGlvbihkcmFnU2hpZnQpO1xuICAgIGlmIChcbiAgICAgIHRoaXMuc2Nyb2xsUG9pbnRlci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AgPCB0aGlzLnNjcm9sbEJhc2UuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wICB8fFxuICAgICAgdGhpcy5zY3JvbGxQb2ludGVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmJvdHRvbSA+IHRoaXMuc2Nyb2xsQmFzZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5ib3R0b21cbiAgICApIHtcbiAgICAgIHRoaXMuc3RvcERyYWcoKTtcbiAgICB9XG4gICAgdGhpcy5zY3JvbGxOb2RlLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZS1zY3JvbGwnKVxuXG4gIH1cblxuICBzZXRTdHlsZVBvc2l0aW9uKHNoaWZ0KSB7XG4gICAgdGhpcy5saW5lTm9kZS5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlM2QoMCwgLSR7c2hpZnR9cHgsIDApYDtcbiAgICB0aGlzLnNjcm9sbFBvaW50ZXIuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZTNkKDAsICR7c2hpZnR9cHgsIDApYDtcbiAgfVxufVxuXG5cbi8vIGhlbHBlcnNcblxuZnVuY3Rpb24gd3JhcEVsZW1lbnRCeURpdih7IGVsZW1lbnQsIGNsYXNzTmFtZSB9KSB7XG4gIGNvbnN0IHdyYXBwZXJOb2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgd3JhcHBlck5vZGUuY2xhc3NMaXN0LmFkZChjbGFzc05hbWUpO1xuXG4gIGVsZW1lbnQucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUod3JhcHBlck5vZGUsIGVsZW1lbnQpO1xuICB3cmFwcGVyTm9kZS5hcHBlbmRDaGlsZChlbGVtZW50KTtcblxuICByZXR1cm4gd3JhcHBlck5vZGU7XG59XG5cblxuIiwiY29uc3QgU2xpZGVyTWFpbiA9IFwic2xpZGVyX19tYWluXCI7XG5jb25zdCBTbGlkZXJEcmFnZ2FibGVDbGFzc25hbWUgPSBcInNsaWRlci1kcmFnZ2FibGVcIjtcbmNvbnN0IFNsaWRlck1haW5MaW5lID0gXCJzbGlkZXJfX2xpbmVcIjtcbmNvbnN0IE1haW5TbGlkZUNsYXNzTmFtZSA9IFwic2xpZGVyX19pdGVtLXdyYXBwZXJcIjtcbmNvbnN0IFBvcHVwU2xpZGVyRG90c0NsYXNzTmFtZSA9IFwic2xpZGVfX2RvdHNcIjtcbmNvbnN0IFBvcHVwU2xpZGVyRG90Q2xhc3NOYW1lID0gXCJzbGlkZV9fZG90XCI7XG5jb25zdCBQb3B1cFNsaWRlckRvdEFjdGl2ZUNsYXNzTmFtZSA9IFwic2xpZGVfX2RvdC1hY3RpdmVcIjtcbmNvbnN0IFBvcHVwU2xpZGVOYXZDbGFzc05hbWUgPSBcInNsaWRlX19uYXZcIjtcbmNvbnN0IFBvcHVwU2xpZGVOYXZMZWZ0Q2xhc3NOYW1lID0gXCJzbGlkZV9fbmF2LWxlZnRcIjtcbmNvbnN0IFBvcHVwU2xpZGVOYXZSaWdodENsYXNzTmFtZSA9IFwic2xpZGVfX25hdi1yaWdodFwiO1xuXG5jbGFzcyBTbGlkZXIge1xuICBjb25zdHJ1Y3RvcihlbGVtZW50KSB7XG4gICAgdGhpcy5jb250YWluZXJOb2RlID0gZWxlbWVudDtcbiAgICB0aGlzLnNpemUgPSBlbGVtZW50LmNoaWxkRWxlbWVudENvdW50O1xuICAgIHRoaXMuY3VycmVudFNsaWRlID0gMDtcbiAgICB0aGlzLmN1cnJlbnRTbGlkZVdhc0NoYW5nZWQgPSBmYWxzZTtcblxuICAgIHRoaXMubWFuYWdlSFRNTCA9IHRoaXMubWFuYWdlSFRNTC5iaW5kKHRoaXMpO1xuICAgIHRoaXMuc2V0UGFyYW1ldGVycyA9IHRoaXMuc2V0UGFyYW1ldGVycy5iaW5kKHRoaXMpO1xuICAgIHRoaXMuc2V0RXZlbnRzID0gdGhpcy5zZXRFdmVudHMuYmluZCh0aGlzKTtcbiAgICB0aGlzLnJlc2l6ZVNsaWRlciA9IHRoaXMucmVzaXplU2xpZGVyLmJpbmQodGhpcyk7XG4gICAgdGhpcy5zdGFydERyYWcgPSB0aGlzLnN0YXJ0RHJhZy5iaW5kKHRoaXMpO1xuICAgIHRoaXMuc3RvcERyYWcgPSB0aGlzLnN0b3BEcmFnLmJpbmQodGhpcyk7XG4gICAgdGhpcy5kcmFnZ2luZyA9IHRoaXMuZHJhZ2dpbmcuYmluZCh0aGlzKTtcbiAgICB0aGlzLnNldFN0eWxlUG9zaXRpb24gPSB0aGlzLnNldFN0eWxlUG9zaXRpb24uYmluZCh0aGlzKTtcbiAgICB0aGlzLnNldFN0eWxlVHJhbnNpdGlvbiA9IHRoaXMuc2V0U3R5bGVUcmFuc2l0aW9uLmJpbmQodGhpcyk7XG4gICAgdGhpcy5yZXNldFN0eWxlVHJhbnNpdGlvbiA9IHRoaXMucmVzZXRTdHlsZVRyYW5zaXRpb24uYmluZCh0aGlzKTtcbiAgICB0aGlzLmdvSG9tZSA9IHRoaXMuZ29Ib21lLmJpbmQodGhpcyk7XG4gICAgdGhpcy5nb1RvU2Vjb25kU2xpZGUgPSB0aGlzLmdvVG9TZWNvbmRTbGlkZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMub3BlblBvcHVwID0gdGhpcy5vcGVuUG9wdXAuYmluZCh0aGlzKTtcbiAgICB0aGlzLmNsb3NlUG9wdXAgPSB0aGlzLmNsb3NlUG9wdXAuYmluZCh0aGlzKTtcbiAgICB0aGlzLmNsaWNrRG90cyA9IHRoaXMuY2xpY2tEb3RzLmJpbmQodGhpcyk7XG4gICAgdGhpcy5tb3ZlVG9MZWZ0ID0gdGhpcy5tb3ZlVG9MZWZ0LmJpbmQodGhpcyk7XG4gICAgdGhpcy5tb3ZlVG9SaWdodCA9IHRoaXMubW92ZVRvUmlnaHQuYmluZCh0aGlzKTtcbiAgICB0aGlzLmNoYW5nZUN1cnJlbnRTbGlkZSA9IHRoaXMuY2hhbmdlQ3VycmVudFNsaWRlLmJpbmQodGhpcyk7XG4gICAgdGhpcy5jaGFuZ2VBY3RpdmVEb3RDbGFzcyA9IHRoaXMuY2hhbmdlQWN0aXZlRG90Q2xhc3MuYmluZCh0aGlzKTtcblxuICAgIHRoaXMubWFuYWdlSFRNTCgpO1xuICAgIHRoaXMuc2V0UGFyYW1ldGVycygpO1xuICAgIHRoaXMuc2V0RXZlbnRzKCk7XG4gIH1cbiAgc2V0UGFyYW1ldGVycygpIHtcbiAgICBjb25zdCBjb29yZHNDb250YWluZXIgPSB0aGlzLmNvbnRhaW5lck5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgdGhpcy53aWR0aCA9IGNvb3Jkc0NvbnRhaW5lci53aWR0aDtcbiAgICB0aGlzLm1heGltdW1YID0gLSh0aGlzLnNpemUgLSAxKSAqIHRoaXMud2lkdGg7XG4gICAgdGhpcy54ID0gLXRoaXMuY3VycmVudFNsaWRlICogdGhpcy53aWR0aDtcbiAgICB0aGlzLnJlc2V0U3R5bGVUcmFuc2l0aW9uKCk7XG4gICAgdGhpcy5saW5lTm9kZS5zdHlsZS53aWR0aCA9IGAke3RoaXMuc2l6ZSAqIHRoaXMud2lkdGh9cHhgO1xuICAgIHRoaXMuc2V0U3R5bGVQb3NpdGlvbigpO1xuICAgIEFycmF5LmZyb20odGhpcy5zbGlkZU5vZGVzKS5mb3JFYWNoKChzbGlkZU5vZGUpID0+IHtcbiAgICAgIHNsaWRlTm9kZS5zdHlsZS53aWR0aCA9IGAke3RoaXMud2lkdGh9cHhgO1xuICAgIH0pO1xuICB9XG4gIG1hbmFnZUhUTUwoKSB7XG4gICAgdGhpcy5jb250YWluZXJOb2RlLmlubmVySFRNTCA9IGBcbiAgICAgPGRpdiBjbGFzcz1cIiR7U2xpZGVyTWFpbkxpbmV9XCI+XG4gICAgICR7dGhpcy5jb250YWluZXJOb2RlLmlubmVySFRNTH1cbiAgICAgPC9kaXY+XG4gICAgIDxkaXYgY2xhc3M9XCIke1BvcHVwU2xpZGVOYXZDbGFzc05hbWV9XCI+XG4gICAgIDxidXR0b24gY2xhc3M9XCIke1BvcHVwU2xpZGVOYXZMZWZ0Q2xhc3NOYW1lfVwiPjwvYnV0dG9uPlxuICAgICA8YnV0dG9uIGNsYXNzPVwiJHtQb3B1cFNsaWRlTmF2UmlnaHRDbGFzc05hbWV9XCI+PC9idXR0b24+XG4gICAgPC9kaXY+XG4gICAgPGRpdiBjbGFzcz1cIiR7UG9wdXBTbGlkZXJEb3RzQ2xhc3NOYW1lfVwiPjwvZGl2PlxuICAgICBgO1xuICAgIHRoaXMubGluZU5vZGUgPSB0aGlzLmNvbnRhaW5lck5vZGUucXVlcnlTZWxlY3RvcihgLiR7U2xpZGVyTWFpbkxpbmV9YCk7XG4gICAgdGhpcy5kb3RzTm9kZSA9IHRoaXMuY29udGFpbmVyTm9kZS5xdWVyeVNlbGVjdG9yKFxuICAgICAgYC4ke1BvcHVwU2xpZGVyRG90c0NsYXNzTmFtZX1gXG4gICAgKTtcblxuICAgIHRoaXMuaG9tZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuaG9tZV9fYnV0dG9uXCIpO1xuICAgIHRoaXMud2hhdHNOZXh0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi53aGF0cy1uZXh0XCIpO1xuICAgIGNvbnNvbGUubG9nKHRoaXMud2hhdHNOZXh0QnV0dG9uKVxuICAgIHRoaXMubW9yZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2xpZGVfX21vcmVcIik7XG4gICAgdGhpcy5jbG9zZVBvcHVwQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fY2xvc2VcIik7XG4gICAgdGhpcy5wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBcIik7XG4gICAgdGhpcy5ib2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImJvZHlcIik7XG4gICAgdGhpcy5zY3JvbGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNjcm9sbFwiKTtcbiAgIHRoaXMubXVjaFNwZXJtID1kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2xpZGVfX3Bpbmstc3Blcm0tc2Vjb25kJylcblxuICAgIHRoaXMuc2xpZGVOb2RlcyA9IEFycmF5LmZyb20odGhpcy5saW5lTm9kZS5jaGlsZHJlbikubWFwKChjaGlsZE5vZGUpID0+XG4gICAgICB3cmFwRWxlbWVudEJ5RGl2KHtcbiAgICAgICAgZWxlbWVudDogY2hpbGROb2RlLFxuICAgICAgICBjbGFzc05hbWU6IE1haW5TbGlkZUNsYXNzTmFtZSxcbiAgICAgIH0pXG4gICAgKTtcblxuICAgIHRoaXMuZG90c05vZGUuaW5uZXJIVE1MID0gQXJyYXkuZnJvbShBcnJheSh0aGlzLnNpemUpLmtleXMoKSlcbiAgICAgIC5tYXAoXG4gICAgICAgIChrZXkpID0+XG4gICAgICAgICAgYDxidXR0b24gY2xhc3M9XCIke1BvcHVwU2xpZGVyRG90Q2xhc3NOYW1lfSAgJHtcbiAgICAgICAgICAgIGtleSA9PT0gdGhpcy5jdXJyZW50U2xpZGUgPyBQb3B1cFNsaWRlckRvdEFjdGl2ZUNsYXNzTmFtZSA6IFwiXCJcbiAgICAgICAgICB9XCI8L2J1dHRvbj4gYFxuICAgICAgKVxuICAgICAgLmpvaW4oXCJcIik7XG5cbiAgICB0aGlzLmRvdE5vZGVzID0gdGhpcy5kb3RzTm9kZS5xdWVyeVNlbGVjdG9yQWxsKFxuICAgICAgYC4ke1BvcHVwU2xpZGVyRG90Q2xhc3NOYW1lfWBcbiAgICApO1xuICAgIHRoaXMubmF2TGVmdCA9IHRoaXMuY29udGFpbmVyTm9kZS5xdWVyeVNlbGVjdG9yKFxuICAgICAgYC4ke1BvcHVwU2xpZGVOYXZMZWZ0Q2xhc3NOYW1lfWBcbiAgICApO1xuICAgIHRoaXMubmF2UmlnaHQgPSB0aGlzLmNvbnRhaW5lck5vZGUucXVlcnlTZWxlY3RvcihcbiAgICAgIGAuJHtQb3B1cFNsaWRlTmF2UmlnaHRDbGFzc05hbWV9YFxuICAgICk7XG4gIH1cbiAgc2V0RXZlbnRzKCkge1xuICAgIHRoaXMuZGVib3VuY2VSZXNpemVTbGlkZXIgPSBkZWJvdW5jZSh0aGlzLnJlc2l6ZVNsaWRlcik7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgdGhpcy5kZWJvdW5jZVJlc2l6ZVNsaWRlcik7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJwb2ludGVydXBcIiwgdGhpcy5zdG9wRHJhZyk7XG4gICAgdGhpcy5tb3JlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLmRlYm91bmNlUmVzaXplU2xpZGVyKTtcbiAgICB0aGlzLmxpbmVOb2RlLmFkZEV2ZW50TGlzdGVuZXIoXCJwb2ludGVyZG93blwiLCB0aGlzLnN0YXJ0RHJhZyk7XG4gICAgdGhpcy5ob21lQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLmdvSG9tZSk7XG4gICAgdGhpcy53aGF0c05leHRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuZ29Ub1NlY29uZFNsaWRlKTtcbiAgICB0aGlzLm1vcmVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMub3BlblBvcHVwKTtcbiAgICB0aGlzLmNsb3NlUG9wdXBCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuY2xvc2VQb3B1cCk7XG4gICAgdGhpcy5kb3RzTm9kZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5jbGlja0RvdHMpO1xuICAgIHRoaXMubmF2TGVmdC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5tb3ZlVG9MZWZ0KTtcbiAgICB0aGlzLm5hdlJpZ2h0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLm1vdmVUb1JpZ2h0KTtcbiAgICB0aGlzLnNjcm9sbC5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcmRvd25cIiwgdGhpcy5zdG9wRHJhZyk7XG4gIH1cbiAgY2xpY2tEb3RzKGUpIHtcbiAgICBjb25zdCBkb3ROb2RlID0gZS50YXJnZXQuY2xvc2VzdChcImJ1dHRvblwiKTtcbiAgICBpZiAoIWRvdE5vZGUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgbGV0IGRvdE51bWJlcjtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuZG90Tm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICh0aGlzLmRvdE5vZGVzW2ldID09PSBkb3ROb2RlKSB7XG4gICAgICAgIGRvdE51bWJlciA9IGk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoZG90TnVtYmVyID09PSB0aGlzLmN1cnJlbnRTbGlkZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLmN1cnJlbnRTbGlkZSA9IGRvdE51bWJlcjtcbiAgICB0aGlzLmNoYW5nZUN1cnJlbnRTbGlkZSgpO1xuICB9XG4gIG1vdmVUb0xlZnQoKSB7XG4gICAgaWYgKHRoaXMuY3VycmVudFNsaWRlIDw9IDApIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5jdXJyZW50U2xpZGUgPSB0aGlzLmN1cnJlbnRTbGlkZSAtIDE7XG4gICAgdGhpcy5jaGFuZ2VDdXJyZW50U2xpZGUoKTtcbiAgfVxuICBtb3ZlVG9SaWdodCgpIHtcbiAgICBpZiAodGhpcy5jdXJyZW50U2xpZGUgPj0gdGhpcy5zaXplIC0gMSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLmN1cnJlbnRTbGlkZSA9IHRoaXMuY3VycmVudFNsaWRlICsgMTtcbiAgICB0aGlzLmNoYW5nZUN1cnJlbnRTbGlkZSgpO1xuICB9XG4gIGNoYW5nZUN1cnJlbnRTbGlkZSgpIHtcbiAgICB0aGlzLnggPSAtdGhpcy5jdXJyZW50U2xpZGUgKiB0aGlzLndpZHRoO1xuICAgIHRoaXMuc2V0U3R5bGVQb3NpdGlvbigpO1xuICAgIHRoaXMuc2V0U3R5bGVUcmFuc2l0aW9uKCk7XG4gICAgdGhpcy5jaGFuZ2VBY3RpdmVEb3RDbGFzcygpO1xuICB9XG4gIGNoYW5nZUFjdGl2ZURvdENsYXNzKCkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5kb3ROb2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgdGhpcy5kb3ROb2Rlc1tpXS5jbGFzc0xpc3QucmVtb3ZlKFBvcHVwU2xpZGVyRG90QWN0aXZlQ2xhc3NOYW1lKTtcbiAgICB9XG4gICAgdGhpcy5kb3ROb2Rlc1t0aGlzLmN1cnJlbnRTbGlkZV0uY2xhc3NMaXN0LmFkZChcbiAgICAgIFBvcHVwU2xpZGVyRG90QWN0aXZlQ2xhc3NOYW1lXG4gICAgKTtcbiAgfVxuICBjbG9zZVBvcHVwKCkge1xuICAgIHRoaXMucG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwLS1hY3RpdmVcIik7XG4gICAgdGhpcy5saW5lTm9kZS5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcmRvd25cIiwgdGhpcy5zdGFydERyYWcpO1xuICB9XG4gIG9wZW5Qb3B1cCgpIHtcbiAgICB0aGlzLnBvcHVwLmNsYXNzTGlzdC5hZGQoXCJwb3B1cC0tYWN0aXZlXCIpO1xuICAgIHRoaXMubGluZU5vZGUucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJkb3duXCIsIHRoaXMuc3RhcnREcmFnKTtcbiAgfVxuICBnb1RvU2Vjb25kU2xpZGUoKSB7XG4gICAgdGhpcy5saW5lTm9kZS5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlM2QoLSR7dGhpcy53aWR0aH1weCwgMCwgMClgO1xuICAgIHRoaXMuY3VycmVudFNsaWRlID0gMTtcbiAgICB0aGlzLnNwZXJtQW5pbWF0ZSgpXG4gIH1cblxuICBnb0hvbWUoKSB7XG4gICAgdGhpcy5saW5lTm9kZS5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlM2QoMCwgMCwgMClgO1xuICAgIHRoaXMuY3VycmVudFNsaWRlID0gMDtcbiAgICBmb3IobGV0IGVsZW1lbnQgb2YgdGhpcy5tdWNoU3Blcm0pIHtcbiAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnYW5pbWF0aW5nJylcbiAgICB9XG4gIH1cblxuICBkZXN0cm95RXZlbnRzKCkge1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwicmVzaXplXCIsIHRoaXMuZGVib3VuY2VSZXNpemVTbGlkZXIpO1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwicG9pbnRlcnVwXCIsIHRoaXMuc3RvcERyYWcpO1xuICAgIHRoaXMubGluZU5vZGUucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJkb3duXCIsIHRoaXMuc3RhcnREcmFnKTtcbiAgICB0aGlzLmRvdHNOb2RlLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLmNsaWNrRG90cyk7XG4gICAgdGhpcy5uYXZMZWZ0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLm1vdmVUb0xlZnQpO1xuICAgIHRoaXMubmF2UmlnaHQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMubW92ZVRvUmlnaHQpO1xuICB9XG4gIHJlc2l6ZVNsaWRlcigpIHtcbiAgICB0aGlzLnNldFBhcmFtZXRlcnMoKTtcbiAgfVxuICBzdGFydERyYWcoZSkge1xuICAgIHRoaXMuY3VycmVudFNsaWRlV2FzQ2hhbmdlZCA9IGZhbHNlO1xuICAgIHRoaXMuY2xpY2tYID0gZS5wYWdlWDtcbiAgICB0aGlzLmNsaWNrWSA9IGUucGFnZVk7XG4gICAgdGhpcy5zdGFydFggPSB0aGlzLng7XG4gICAgdGhpcy5yZXNldFN0eWxlVHJhbnNpdGlvbigpO1xuXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJwb2ludGVybW92ZVwiLCB0aGlzLmRyYWdnaW5nKTtcblxuICB9XG4gIHN0b3BEcmFnKCkge1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwicG9pbnRlcm1vdmVcIiwgdGhpcy5kcmFnZ2luZyk7XG4gICAgdGhpcy5jb250YWluZXJOb2RlLmNsYXNzTGlzdC5yZW1vdmUoU2xpZGVyRHJhZ2dhYmxlQ2xhc3NuYW1lKTtcbiAgICB0aGlzLmNoYW5nZUN1cnJlbnRTbGlkZSgpO1xuICAgICAgIGlmKHRoaXMuY3VycmVudFNsaWRlID09PSAxKSB7XG4gICAgICAgIHRoaXMuc3Blcm1BbmltYXRlKClcbiAgICB9XG5cbiAgICBjb25zdCBpbWdzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2ltZycpXG4gICAgZm9yKGxldCBpbWcgb2YgaW1ncykge1xuICAgICAgaW1nLm9uZHJhZ3N0YXJ0ID0gKCkgPT4ge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9O1xuICAgIH1cbiAgfVxuICBzcGVybUFuaW1hdGUoKSB7XG4gICAgZm9yKGxldCBlbGVtZW50IG9mIHRoaXMubXVjaFNwZXJtKSB7XG4gZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdhbmltYXRpbmcnKVxufVxufVxuICBkcmFnZ2luZyhlKSB7XG4gICAgaWYgKFxuICAgICAgZG9jdW1lbnRcbiAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuc2Nyb2xsLXdyYXBwZXJcIilcbiAgICAgICAgLmNsYXNzTGlzdC5jb250YWlucyhcImFjdGl2ZS1zY3JvbGxcIilcbiAgICApIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5kcmFnWCA9IGUucGFnZVg7XG4gICAgY29uc3QgZHJhZ1NoaWZ0ID0gdGhpcy5kcmFnWCAtIHRoaXMuY2xpY2tYO1xuICAgIGNvbnN0IGVhc2luZyA9IGRyYWdTaGlmdCAvIDU7XG4gICAgdGhpcy54ID0gTWF0aC5tYXgoXG4gICAgICBNYXRoLm1pbih0aGlzLnN0YXJ0WCArIGRyYWdTaGlmdCwgZWFzaW5nKSxcbiAgICAgIHRoaXMubWF4aW11bVggKyBlYXNpbmdcbiAgICApO1xuICAgIHRoaXMuc2V0U3R5bGVQb3NpdGlvbigpO1xuXG4gICAgLy8gY2hhbmdlIGFjdGl2ZSBzbGlkZVxuICAgIGlmIChcbiAgICAgIGRyYWdTaGlmdCA+IDIwICYmXG4gICAgICBkcmFnU2hpZnQgPiAwICYmXG4gICAgICAhdGhpcy5jdXJyZW50U2xpZGVXYXNDaGFuZ2VkICYmXG4gICAgICB0aGlzLmN1cnJlbnRTbGlkZSA+IDBcbiAgICApIHtcbiAgICAgIHRoaXMuY29udGFpbmVyTm9kZS5jbGFzc0xpc3QuYWRkKFNsaWRlckRyYWdnYWJsZUNsYXNzbmFtZSk7XG4gICAgICB0aGlzLmN1cnJlbnRTbGlkZVdhc0NoYW5nZWQgPSB0cnVlO1xuICAgICAgdGhpcy5jdXJyZW50U2xpZGUgPSB0aGlzLmN1cnJlbnRTbGlkZSAtIDE7XG4gICAgfVxuICAgIGlmIChcbiAgICAgIGRyYWdTaGlmdCA8IC0yMCAmJlxuICAgICAgZHJhZ1NoaWZ0IDwgMCAmJlxuICAgICAgIXRoaXMuY3VycmVudFNsaWRlV2FzQ2hhbmdlZCAmJlxuICAgICAgdGhpcy5jdXJyZW50U2xpZGUgPCB0aGlzLnNpemUgLSAxXG4gICAgKSB7XG4gICAgICB0aGlzLmNvbnRhaW5lck5vZGUuY2xhc3NMaXN0LmFkZChTbGlkZXJEcmFnZ2FibGVDbGFzc25hbWUpO1xuICAgICAgdGhpcy5jdXJyZW50U2xpZGVXYXNDaGFuZ2VkID0gdHJ1ZTtcbiAgICAgIHRoaXMuY3VycmVudFNsaWRlID0gdGhpcy5jdXJyZW50U2xpZGUgKyAxO1xuICAgIH1cbiAgfVxuXG4gIHNldFN0eWxlUG9zaXRpb24oKSB7XG4gICAgdGhpcy5saW5lTm9kZS5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlM2QoJHt0aGlzLnh9cHgsIDAsIDApYDtcbiAgfVxuICBzZXRTdHlsZVRyYW5zaXRpb24oKSB7XG4gICAgdGhpcy5saW5lTm9kZS5zdHlsZS50cmFuc2l0aW9uID0gYGFsbCAuM3MgZWFzZSAwc2A7XG4gIH1cbiAgcmVzZXRTdHlsZVRyYW5zaXRpb24oKSB7XG4gICAgdGhpcy5saW5lTm9kZS5zdHlsZS50cmFuc2l0aW9uID0gYGFsbCAwIGVhc2UgMHNgO1xuICB9XG59XG5cbi8vIGhlbHBlcnNcbmZ1bmN0aW9uIHdyYXBFbGVtZW50QnlEaXYoeyBlbGVtZW50LCBjbGFzc05hbWUgfSkge1xuICBjb25zdCB3cmFwcGVyTm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIHdyYXBwZXJOb2RlLmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKTtcblxuICBlbGVtZW50LnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHdyYXBwZXJOb2RlLCBlbGVtZW50KTtcbiAgd3JhcHBlck5vZGUuYXBwZW5kQ2hpbGQoZWxlbWVudCk7XG5cbiAgcmV0dXJuIHdyYXBwZXJOb2RlO1xufVxuXG5mdW5jdGlvbiBkZWJvdW5jZShmdW5jLCB0aW1lID0gMTAwKSB7XG4gIGxldCB0aW1lcjtcbiAgcmV0dXJuIGZ1bmN0aW9uIChlKSB7XG4gICAgY2xlYXJUaW1lb3V0KHRpbWVyKTtcbiAgICB0aW1lciA9IHNldFRpbWVvdXQoZnVuYywgdGltZSwgZSk7XG4gIH07XG59XG5cbmNsYXNzIFBvcHVwU2xpZGVyIGV4dGVuZHMgU2xpZGVyIHtcbiAgY29uc3RydWN0b3IoZWxlbWVudCkge1xuICAgIHN1cGVyKGVsZW1lbnQpO1xuICB9XG5cbiAgb3BlblBvcHVwKCkge1xuICAgIHRoaXMubGluZU5vZGUuYWRkRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJkb3duXCIsIHRoaXMuc3RhcnREcmFnKTtcbiAgfVxufVxuIiwiXG5cbm5ldyBTbGlkZXIoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NsaWRlcl9fbWFpbicpKVxubmV3IEFkZFNsaWRlcihkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2Vjb25kLXNsaWRlcicpKVxuXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcgLCAoKSA9PiB7XG4gIG5ldyBQb3B1cFNsaWRlcihkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncG9wdXBfX3NsaWRlcicpKVxufSlcbiJdfQ==
